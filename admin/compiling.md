# checkinstall
## How can I install the latest version of the script?

    $ git clone http://checkinstall.izto.org/checkinstall.git

    # from the INSTALL file
    $ make
    $ su
    $ make install
    $ checkinstall

##
## Which `$ make` command does checkinstall run by default?

    $ make install

### How to pass it an arbitrary `$ make` command?

Just write it right afterwards:

    $ sudo checkinstall make foo

Equivalent of `$  make install foo`, except  that a deb package  is produced and
installed via `$ dpkg -i foo`.

##
## The installation fails!  “trying to overwrite '...', which is also in package”

If you  know that  the file  which the package  was trying  to overwrite  is not
important, you can manually install the .deb generated by checkinstall:

    $ sudo dpkg -i --force-overwrite package.deb

Otherwise, you'll  have to uninstall  the conflicting package which  has already
installed the problematic file.

<https://askubuntu.com/q/176121/867754>

---

Alternatively, if  the path  of the  file ends  with `info/dir`,  try to  find a
configuration option allowing  you to change the location of  the file; it could
be `--infodir`.

Example:

    $ ./configure --infodir=/usr/local/share
                    ^^^^^^^^^^^^^^^^^^^^^^^^
                    move the info file from `/usr/share/info` to `/usr/local/share/info`

##
# debian source packages
## How to download a debian source package?

Find in which section the file is located:

    $ aptitude show <package> | grep Section

Uncomment the matching `deb-src` line in `/etc/apt/sources.list`.

Update:

    $ sudo aptitude update

Download the source package:

    $ apt-get source <package_name>

This will download the source code in a directory, as well as a few other files:

    vim-7.4.1689~
    vim_7.4.1689-3ubuntu1.debian.tar.xz~
    vim_7.4.1689-3ubuntu1.dsc~
    vim_7.4.1689.orig.tar.gz~

If  `$  apt-cache policy`  reports  several  versions,  you  can target  one  in
particular with:

    $ apt-get source <package_name>=<version>

### How to recompile it?

    $ dpkg-buildpackage -us -uc

You must  be in the source  code tree when you  run the command, and  the deb is
written in the parent directory (where the .dsc file lives), not the current one.

See the chapter 15 “Creating a Debian Package” in The Debian Administrator's Handbook.
More specifically the subchapter 15.1.3. “Starting the Rebuild”.

#### Should I apply the debian patches first?

No, they've been automatically applied by `$ apt-get source`:

    $ apt-get source vim
    ...~
    dpkg-source: info: applying 0001-Detect-the-rst-filetype-using-the-contents-of-the-fi.patch~
    dpkg-source: info: applying 0002-Support-sourcing-a-vimrc.tiny-when-Vim-is-invoked-as.patch~
    dpkg-source: info: applying 0003-Add-recognition-of-more-LaTeX-commands-for-tex-filet.patch~
    dpkg-source: info: applying 0004-Document-Debian-s-decision-to-disable-modelines-by-d.patch~
    dpkg-source: info: applying 0005-Support-defining-compilation-date-in-SOURCE_DATE_EPO.patch~
    dpkg-source: info: applying 0006-debsources.vim-Move-trusty-to-unsupported.patch~
    dpkg-source: info: applying ubuntu-grub-syntax.patch~
    dpkg-source: info: applying update-upstart-syntax.patch~
    dpkg-source: info: applying ubuntu-releases.patch~

#### Which package(s) will be compiled by the previous command?

Any package listed in:

    $ grep -i ^binary: *.dsc

##
## How to find
### the dependencies of a debian source package?

    $ grep -i build-depends: *.dsc
                               │
                               └ Debian Source Control

You can also find the information in the `debian/control` file.

#### Are they all necessary for a compilation?

Not necessarily.

The authoritative  resource on that matter  is the INSTALL file  or some similar
documentation provided by the project.

####
### the configuration options which were used to compile a debian source package?

Read the file `debian/rules`:

    $ vim rxvt-unicode-9.22/debian/rules

And find the right recipe (e.g. `conf-unicode-256color`):

    conf-unicode-256color:
            $(flagscommon) ./configure $(cfgcommon) \
                --enable-unicode3 \
                --enable-combining \
                --enable-xft \
                --enable-font-styles \
                --enable-256-color \
                --enable-pixbuf \
                --enable-transparency \
                --enable-fading \
                --enable-rxvt-scroll \
                --enable-next-scroll \
                --enable-xterm-scroll \
                --enable-perl \
                --enable-xim \
                --enable-iso14755 \
                --enable-mousewheel \
                --enable-slipwheeling \
                --enable-smart-resize \
                --enable-startup-notification \
                --with-term=rxvt-unicode-256color

---

Alternatively, you can try to read the buildlog on the web.

For example, for `zsh`, you would first visit:
<https://launchpad.net/ubuntu/+source/zsh>

Then, you would click on the button below “Latest upload”:
<https://launchpad.net/ubuntu/+source/zsh/5.5.1-1ubuntu3>

Then, on the button “amd64” in the section “Builds”:
<https://launchpad.net/ubuntu/+source/zsh/5.5.1-1ubuntu3/+build/16608683>

Finally, on the button “buildlog”:
<https://launchpadlibrarian.net/418666830/buildlog_ubuntu-disco-amd64.zsh_5.5.1-1ubuntu3_BUILDING.txt.gz>

##
## What happens if I pass the name of a binary package to `$ apt-get source`?

It will be replaced with the source package from which it can be compiled.

    $ apt-get source vim-gtk
    ...~
    Reading package lists... Done~
    Picking 'vim' as source package instead of 'vim-gtk'~

## I found a PPA.  Why do the names of its packages on the web differ from the packages I install on my system?

The package names you see on a page like this:
<https://launchpad.net/~pi-rho/+archive/ubuntu/dev>
... are for *source* packages.
You can  compile a  source code  with various  configuration options  to produce
different binaries.

For example, from the Vim source code, you can compile `vim-gtk` or `vim-tiny`.

    $ apt-get source vim
    $ vim -es vim-*/debian/control +'g/^Package/p' +'qa!'
    Package: vim-common~
    Package: vim-gui-common~
    Package: vim-runtime~
    Package: vim-doc~
    Package: vim-tiny~
    Package: vim~
    Package: vim-gtk~
    Package: vim-gtk3~
    Package: vim-nox~
    Package: vim-athena~
    Package: vim-gnome~
    Package: vim-gtk-py2~
    Package: vim-gtk3-py2~
    Package: vim-nox-py2~
    Package: vim-athena-py2~
    Package: vim-gnome-py2~

##
# Todo

Document these utilities:
<https://wiki.debian.org/apt-src>
<https://help.ubuntu.com/community/AutoApt>
<https://wiki.ubuntu.com/AutoDeb>

auto-apt can find missing dependencies:

    $ auto-apt search Xlib.h
    usr/include/X11/Xlib.h  libdevel/libx11-dev~

But you need to update its database.

    $ sudo auto-apt update
    $ sudo auto-apt updatedb && sudo auto-apt update-local

And that takes a long time (≈ 25 min).
I don't know how often you have to update.
If you interrupt  an update with `C-c`, the utility  seems broken afterwards; it
doesn't find anything anymore, and you have to restart a complete update.

autodeb is an  experimental script that should perform the  job of both auto-apt
and checkinstall at the same time.

